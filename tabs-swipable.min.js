angular.module("ionic").directive("tabsSwipable",["$ionicGesture",function(e){return{restrict:"A",require:"ionTabs",link:function(t,n,a,r){var i={},o=!1,s=!1;null!=a.tabsSwipableLoop&&(-1==["true","false"].indexOf(a.tabsSwipableLoop)?console.error("tabsSwipable: tabsSwipableLoop value should be true or false, '"+a.tabsSwipableLoop+"' is given."):o="true"==a.tabsSwipableLoop);var l=function(e){if(null==document.querySelector("[tabs-swipable].tabs-item-hide")&&!s){document.contains(document.getElementById("ionTabsAnimatedStyle"))&&document.getElementById("ionTabsAnimatedStyle").remove();for(var n=0;n<r.tabs.length;n++)ionView=angular.element(document.querySelector("ion-nav-view[name='"+r.tabs[n].navViewName+"']")),ionView.css({left:"initial"}),n!=r.selectedIndex()&&ionView.attr("nav-view","cached");if(e.gesture.distance>window.screen.width/1.6||e.gesture.distance/(e.gesture.timeStamp-e.gesture.startEvent.timeStamp)>.1){var a=r.selectedIndex();"right"==e.gesture.direction&&a--,"left"==e.gesture.direction&&a++,a>=0&&a<r.tabs.length?a!=r.selectedIndex()&&t.$apply(r.select(a)):o&&(-1==a?a!=r.selectedIndex()&&t.$apply(r.select(r.tabs.length-1)):a==r.tabs.length&&a!=r.selectedIndex()&&t.$apply(r.select(0)))}}},d=function(e){var t=nextTarget=r.selectedIndex(),n=angular.element(document.querySelector("ion-nav-view[name='"+r.tabs[t].navViewName+"']")),a=null,i=document.querySelector("[tabs-swipable].tabs-item-hide"),l=document.querySelector("[tabs-swipable] .tabs .tab-item.tab-item-active");if(null==i&&!s){var d=l.offsetWidth,u=document.getElementById("ionTabsAnimatedStyle")||document.createElement("style");if(u.setAttribute("id","ionTabsAnimatedStyle"),u.innerHTML=".tab-item-active::after{position: absolute;width: "+d+"px;}",u.innerHTML+=".tab-item-active::after{transform: translateX( "+-e.gesture.deltaX/5+"px);}",t<0)return;if("right"==e.gesture.direction&&nextTarget--,"left"==e.gesture.direction&&nextTarget++,nextTarget>=0&&nextTarget<r.tabs.length?a=angular.element(document.querySelector("ion-nav-view[name='"+r.tabs[nextTarget].navViewName+"']")):o&&(-1==nextTarget?a=angular.element(document.querySelector("ion-nav-view[name='"+r.tabs[r.tabs.length-1].navViewName+"']")):nextTarget==r.tabs.length&&(a=angular.element(document.querySelector("ion-nav-view[name='"+r.tabs[0].navViewName+"']")))),o||"right"==e.gesture.direction&&nextTarget>=0||"left"==e.gesture.direction&&nextTarget<r.tabs.length){var c={};c.left=e.gesture.deltaX+"px",n.css(c),"left"==e.gesture.direction&&(c.left=window.screen.width+e.gesture.deltaX+"px"),"right"==e.gesture.direction&&(c.left=e.gesture.deltaX-window.screen.width+"px"),a.attr("nav-view","active"),a.css(c),document.getElementsByTagName("head")[0].append(u)}}},u=function(e){s=!1;var t=document.querySelector("[edge-drag-threshold]");if(t){var n=t.getAttribute("edge-drag-threshold");n&&e.touches&&e.touches.length>0&&e.touches[0].clientX<=n&&(s=!0)}};i.touchstart=e.on("mousedown touchstart",u,n),i.drag=e.on("drag",d,n),i.dragend=e.on("dragend",l,n),t.$on("$destroy",(function(){e.off(i.touchstart,"mousedown touchstart",u),e.off(i.drag,"drag",d),e.off(i.dragend,"dragend",l)}))}}}]);